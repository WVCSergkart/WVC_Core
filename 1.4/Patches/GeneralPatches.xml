<?xml version="1.0" encoding="utf-8"?>
<Patch>

	<Operation Class="PatchOperationAdd">
	  <xpath>/Defs/TraderKindDef[defName="Orbital_BulkGoods" or defName="Orbital_Exotic" or defName="Empire_Caravan_TraderGeneral" or defName="Orbital_Empire"]/stockGenerators</xpath>
	  <value>
		  <li Class="StockGenerator_SingleDef">
			<thingDef>VFE_ComponentMechanoid</thingDef>
			<countRange>0~8</countRange>
		  </li>
	  </value>
	</Operation>

	<Operation Class="XmlExtensions.PatchOperationSafeAdd">
	  <xpath>/Defs/ThingDef[defName="Steel" or defName="Plasteel" or defName="Gold" or defName="Uranium" or defName="Silver" or defName="Moyo_Abyssteel" or defName="DankPyon_IronIngot" or defName="VMEu_Iron" or defName="VMEu_Lead" or defName="VMEu_Bronze" or defName="VFEC_Bronze" or defName="VMEu_Tin" or defName="VMEu_Copper" or defName="VMEu_Tungsten" or defName="VMEu_Chromium" or defName="VMEu_StainlessSteel" or defName="VMEu_Titanium" or defName="VMEu_Lithium" or defName="VMEu_Germanium"]</xpath>
	  <safetyDepth>1</safetyDepth>
	  <value>
		<thingCategories>
		  <li>WVC_MetalResources_Raw</li>
		</thingCategories>
	  </value>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.PatchOperationSafeAdd">
	  <xpath>/Defs/ThingDef[defName="ComponentIndustrial" or defName="ComponentSpacer" or defName="VFE_ComponentMechanoid" or defName="RE_PrefabComponent" or defName="DankPyon_ComponentBasic"]</xpath>
	  <safetyDepth>1</safetyDepth>
	  <value>
		<thingCategories>
		  <li>WVC_ManufacturedComponents</li>
		</thingCategories>
	  </value>
	</Operation>

	<Operation Class="XmlExtensions.FindMod">
		<mods>
			<li>dankpyon.medieval.overhaul</li>
		</mods>
		<packageId>true</packageId>
		<caseTrue>

			<Operation Class="PatchOperationReplace">
			  <xpath>/Defs/ThingDef[defName="DankPyon_BarrelComponentBasic"]/building/fixedStorageSettings</xpath>
			  <value>
				  <fixedStorageSettings>
					<filter>
						<categories>
							<li>WVC_ManufacturedComponents</li>
						</categories>
					</filter>
				  </fixedStorageSettings>
			  </value>
			</Operation>

			<Operation Class="PatchOperationReplace">
			  <xpath>/Defs/ThingDef[defName="DankPyon_BarrelComponentBasic"]/building/defaultStorageSettings</xpath>
			  <value>
				  <defaultStorageSettings>
					<priority>Important</priority>
					<filter>
						<categories>
							<li>WVC_ManufacturedComponents</li>
						</categories>
					</filter>
				  </defaultStorageSettings>
			  </value>
			</Operation>

		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.OptionalPatch">
		<modId>honkai.girls.sergkart</modId>
		<key>WVC_NoKL_DisableUnderwear_Option</key>
		<defaultValue>false</defaultValue>
		<caseTrue>

			<Operation Class="XmlExtensions.FindMod">
				<mods>
					<li>honkai.girls.sergkart</li>
				</mods>
				<packageId>true</packageId>
				<caseFalse>

					<Operation Class="XmlExtensions.PatchOperationSafeRemove">
						<xpath>/Defs/ThingDef[@ParentName="WVC_Apparel_PerfectUnderwear" or @Name="WVC_Apparel_PerfectUnderwear"]</xpath>
					</Operation>

				</caseFalse>
				<caseTrue>

					<Operation Class="PatchOperationAdd">
						<xpath>/Defs/AlienRace.ThingDef_AlienRace[@Name="BaseValkyrie_WVC"]/alienRace/raceRestriction/apparelList</xpath>
						<value>
							<li>WVC_Apparel_PerfectUnderwear</li>
							<li>WVC_Apparel_WarmUnderwear</li>
							<li>WVC_Apparel_SummerUnderwear</li>
							<li>WVC_Apparel_ThermalUnderwear</li>
							<li>WVC_Apparel_ExoticUnderwear</li>
						</value>
					</Operation>

				</caseTrue>
			</Operation>

		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<!-- <Operation Class="XmlExtensions.FindMod"> -->
		<!-- <mods> -->
			<!-- <li>ludeon.rimworld.royalty</li> -->
		<!-- </mods> -->
		<!-- <packageId>true</packageId> -->
		<!-- <caseTrue> -->

			<!-- <Operation Class="PatchOperationAdd"> -->
			  <!-- <xpath>/Defs/TraderKindDef[defName="Orbital_Empire"]/stockGenerators</xpath> -->
			  <!-- <value> -->
			  <!-- </value> -->
			<!-- </Operation> -->

		<!-- </caseTrue> -->
	<!-- </Operation> -->

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.FindMod">
		<mods>
			<li>vanillaexpanded.outposts</li>
		</mods>
		<packageId>true</packageId>
		<!-- <logic>or</logic> -->
		<caseTrue>
			<Operation Class="PatchOperationAdd">
			  <xpath>/Defs/WorldObjectDef[defName="Outpost_Production"]/modExtensions/li[@Class="Outposts.OutpostExtension_Choose"]/ResultOptions</xpath>
			  <value>
				  <li>
					<Thing>VFE_ComponentMechanoid</Thing>
					<AmountsPerSkills>
					  <Crafting>1</Crafting>
					</AmountsPerSkills>
					<MinSkills>
					  <Crafting>50</Crafting>
					  <Intellectual>20</Intellectual>
					</MinSkills>
				  </li>
			  </value>
			</Operation>
		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<!-- <Operation Class="XmlExtensions.FindMod"> -->
		<!-- <mods> -->
			<!-- <li>vanillaexpanded.ideo.dryads</li> -->
			<!-- <li>isorex.communityframework</li> -->
		<!-- </mods> -->
		<!-- <packageId>true</packageId> -->
		<!-- <caseFalse> -->

			<!-- <Operation Class="XmlExtensions.PatchOperationSafeRemove"> -->
			  <!-- <xpath>/Defs/ThingDef[defName="WVC_IncubatorLF"]/comps/li[@Class="CompProperties_Spawner"]</xpath> -->
			<!-- </Operation> -->

			<!-- <Operation Class="XmlExtensions.PatchOperationSafeRemove"> -->
			  <!-- <xpath>/Defs/ThingDef[defName="WVC_CapsuleILF"]</xpath> -->
			<!-- </Operation> -->

		<!-- </caseFalse> -->
	<!-- </Operation> -->

	<!--=====================================================================-->

	<!-- <Operation Class="XmlExtensions.FindMod"> -->
		<!-- <mods> -->
			<!-- <li>oskarpotocki.vfe.classical</li> -->
		<!-- </mods> -->
		<!-- <packageId>true</packageId> -->
		<!-- <caseTrue> -->

			<!-- <li Class="XmlExtensions.PatchOperationSafeRemove"> -->
				<!-- <xpath>/Defs/ThingDef[@WVC_Tag="NoHeadsBeds"]/building/bed_maxBodySize</xpath> -->
			<!-- </li> -->

		<!-- </caseTrue> -->
	<!-- </Operation> -->

	<!-- <Operation Class="XmlExtensions.FindMod"> -->
		<!-- <mods> -->
			<!-- <li>ludeon.rimworld.ideology</li> -->
			<!-- <li>ludeon.rimworld.royalty</li> -->
		<!-- </mods> -->
		<!-- <packageId>true</packageId> -->
		<!-- <logic>and</logic> -->
		<!-- <caseTrue> -->

			<!-- <Operation Class="XmlExtensions.PatchOperationAddOrReplace"> -->
				  <!-- <xpath>Defs/ThingDef[defName="Plant_TreeGauranlen" or defName="Plant_TreeAnima"]/plant</xpath> -->
				  <!-- <value> -->
					<!-- <minSpacingBetweenSamePlant>1.9</minSpacingBetweenSamePlant> -->
				  <!-- </value> -->
			<!-- </Operation> -->

		<!-- </caseTrue> -->
	<!-- </Operation> -->

	<Operation Class="XmlExtensions.FindMod">
		<mods>
			<li>ludeon.rimworld.ideology</li>
			<li>kentington.saveourship2</li>
		</mods>
		<packageId>true</packageId>
		<logic>and</logic>
		<caseTrue>

			<!-- SoS + Gaurler patch -->

			<Operation Class="XmlExtensions.PatchOperationSafeAdd">
				<xpath>/Defs/ThingDef[@Name="DryadBase"]</xpath>
				<safetyDepth>1</safetyDepth>
				<value>
					<tradeTags>
						<li MayRequire="kentington.saveourship2">AnimalInsectSpace</li>
					</tradeTags>
				</value>
			</Operation>

			<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
				<xpath>Defs/ThingDef[@Name="DryadBase"]/statBases</xpath>
				<value>
					<ComfyTemperatureMin>-100</ComfyTemperatureMin>
				</value>
			</Operation>

		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.FindMod">
		<mods>
			<li>ludeon.rimworld.ideology</li>
		</mods>
		<packageId>true</packageId>
		<caseTrue>

			<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
				  <xpath>Defs/ThingDef[@Name="DryadBase"]/statBases</xpath>
				  <value>
					<WVC_CorruptionSensitivity>0.0</WVC_CorruptionSensitivity>
				  </value>
			</Operation>

		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
		  <xpath>Defs/StatDef[defName="MentalBreakThreshold"]</xpath>
		  <value>
			<minValue>0</minValue>
		  </value>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
		  <xpath>Defs/ThingDef[@Name="BaseMechanoid"]/statBases</xpath>
		  <value>
			<WVC_CorruptionSensitivity>0.05</WVC_CorruptionSensitivity>
		  </value>
	</Operation>
	<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
		  <xpath>Defs/ThingDef[@Name="BaseInsect"]/statBases</xpath>
		  <value>
			<WVC_CorruptionSensitivity>0.1</WVC_CorruptionSensitivity>
		  </value>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.FindMod">
		<mods>
			<li>vanillaexpanded.vaeaccessories</li>
		</mods>
		<packageId>true</packageId>
		<caseTrue>

			<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
				  <xpath>Defs/ThingDef[defName="WVC_Apparel_MechanoidShieldBelt"]</xpath>
				  <value>
					<thingClass>VAE_Accessories.RangedShieldBelt</thingClass>
				  </value>
			</Operation>

		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="PatchOperationAdd">
		  <xpath>Defs/InventoryStockGroupDef[defName="Medicine"]/thingDefs</xpath>
		  <value>
			<li>WVC_MedicineMechanite</li>
		  </value>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.FindMod">
		<mods>
			<li>ceteam.combatextended</li>
		</mods>
		<packageId>true</packageId>
		<caseFalse>

			<Operation Class="XmlExtensions.ApplyPatch">
				<patchName>Autopatcher_CureInjury_Patch_WVC</patchName>
				<arguments>
					<li>InjuryBase</li>
					<li>Injury</li>
					<li>AnimalThingBase</li>
				</arguments>
			</Operation>

			<Operation Class="XmlExtensions.OptionalPatch">
				<modId>honkai.girls.sergkart</modId>
				<key>Valkyries_RemoveDodgeLimit_WVC</key>
				<defaultValue>false</defaultValue>
				<caseTrue>
					<Operation Class="PatchOperationReplace">
					  <xpath>/Defs/StatDef[defName="MeleeDodgeChance"]/postProcessCurve</xpath>
					  <value>
						<postProcessCurve>
						  <points>
							<li>(5, 0)</li>
							<li>(20, 0.30)</li>
							<li>(60, 0.50)</li>
							<li>(100, 0.70)</li>
							<li>(150, 0.90)</li>
							<li>(250, 0.95)</li>
							<li>(500, 1.00)</li>
						  </points>
						</postProcessCurve>
					  </value>
					</Operation>
				</caseTrue>
			</Operation>

		</caseFalse>
		<caseTrue>

			<Operation Class="XmlExtensions.PatchOperationSafeRemove">
				<xpath>Defs/ThingDef[@WVC_CE_Tag="DoesNotSupport"]</xpath>
			</Operation>

		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.OptionalPatch">
		<modId>honkai.girls.sergkart</modId>
		<key>ComponentMechanoid_GirlyResource_UniversalFuel_WVC</key>
		<defaultValue>false</defaultValue>
		<caseTrue>

		   <Operation Class="PatchOperationAdd">
			  <xpath>/Defs/ThingDef/comps/li[@Class="CompProperties_Refuelable"]/fuelFilter/thingDefs</xpath> 
			  <value>
				<li>WVC_UniversalFuel</li>
			  </value>
		   </Operation>

		</caseTrue>
	</Operation>

	<Operation Class="XmlExtensions.OptionalPatch">
		<modId>honkai.girls.sergkart</modId>
		<key>WVC_DesignationCategory_Patch</key>
		<defaultValue>false</defaultValue>
		<caseFalse>

			<li Class="XmlExtensions.PatchOperationSafeRemove">
				<xpath>/Defs/DesignationCategoryDef[defName="WVC_Category"]</xpath>
			</li>

		</caseFalse>
		<caseTrue>

			<Operation Class="XmlExtensions.ForEachDescendant">
				<xpathParent>/Defs/ThingDef[@Name="BaseBuildings_WVC"]</xpathParent>
				<concreteOnly>true</concreteOnly>
				<storeIn>WVC_Def</storeIn>
				<apply>
					<Operation Class="XmlExtensions.CreateVariable">
						<value>{WVC_Def}/defName</value>
						<storeIn>WVC_Name</storeIn>
						<fromXml>true</fromXml>
						<apply>
							<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
								<xpath>/Defs/ThingDef[defName="{WVC_Name}"]</xpath>
								<value>
									<designationCategory>WVC_Category</designationCategory>
								</value>
							</Operation>
						</apply>
					</Operation>
				</apply>
			</Operation>
			<Operation Class="XmlExtensions.PatchOperationAddOrReplace">
				<xpath>/Defs/TerrainDef[@Name="Marker_Floor_WVC"]</xpath>
				<value>
					<designationCategory>WVC_Category</designationCategory>
				</value>
			</Operation>

		</caseTrue>
	</Operation>

	<!--=====================================================================-->

	<Operation Class="XmlExtensions.OptionalPatch">
		<modId>honkai.girls.sergkart</modId>
		<key>WVC_Buildings_UniversalConduit_SupportPatch_VCHE</key>
		<defaultValue>True</defaultValue>
		<caseFalse>

			<li Class="XmlExtensions.PatchOperationSafeRemove">
				<xpath>/Defs/ThingDef[defName="WVC_UniversalConduit"]/comps/li[@MayRequire="vanillaexpanded.vchemfuele"]</xpath>
			</li>

		</caseFalse>
	</Operation>

	<Operation Class="XmlExtensions.OptionalPatch">
		<modId>honkai.girls.sergkart</modId>
		<key>WVC_Buildings_UniversalConduit_SupportPatch_VFEP</key>
		<defaultValue>True</defaultValue>
		<caseFalse>

			<li Class="XmlExtensions.PatchOperationSafeRemove">
				<xpath>/Defs/ThingDef[defName="WVC_UniversalConduit"]/comps/li[@MayRequire="vanillaexpanded.vfepower"]</xpath>
			</li>

		</caseFalse>
	</Operation>

	<Operation Class="XmlExtensions.OptionalPatch">
		<modId>honkai.girls.sergkart</modId>
		<key>WVC_Buildings_UniversalConduit_SupportPatch_SOS</key>
		<defaultValue>True</defaultValue>
		<caseFalse>

			<li Class="XmlExtensions.PatchOperationSafeRemove">
				<xpath>/Defs/ThingDef[defName="WVC_UniversalConduit"]/comps/li[@MayRequire="kentington.saveourship2"]</xpath>
			</li>

		</caseFalse>
	</Operation>

	<!--=====================================================================-->

	<!-- <Operation Class="XmlExtensions.FindMod"> -->
		<!-- <mods> -->
			<!-- <li>ahndemi.panieltheautomata</li> -->
		<!-- </mods> -->
		<!-- <packageId>true</packageId> -->
		<!-- <logic>and</logic> -->
		<!-- <caseTrue> -->

		<!-- </caseTrue> -->
	<!-- </Operation> -->

	<!--=====================================================================-->


</Patch>